{% extends 'Main/base.html'%}
{% load static %}
{% block title%}Home{% endblock%}
{% block content %}

<br>
{% if investments %}
<div class="row justify-content-between">
   <div class="col-5">
      <div class="col-md">
         <div class="card text-center text-dark mb-3">

            <div class="card-body">
               <h2 class="card-title">Welcome Back, {{user.first_name|title}}!</h2>
            </div>
         </div>
      </div>
   </div>
   <div class="col-5">
      <div class="col-md">
         <div class="card text-center text-dark mb-3">

            <div class="card-body">
               <h2 class="card-title">Available to invest: ${{ investments.get_available_balance }}</h2>
            </div>
         </div>
      </div>
   </div>

</div>


<br>
<table class="table">
   <thead>
      <tr>
         <th scope="col">Asset Class</th>
         <th scope="col">Investment Market</th>
         <th scope="col">Amount</th>
         <th scope="col">Mass</th>
      </tr>
   </thead>
   <tbody>
      {% for saving in savings %}
      <tr>
         <th scope="row">Savings</th>
         <td>{{saving.investmentMarkets}}</td>
         <td>${{saving.amount}}</td>
         <td>{{saving.percentage}}%</td>
      </tr>
      {% endfor %}
   </tbody>
   <tbody>
      {% for insurance in insurance %}
      <tr>
         <th scope="row">Insurance</th>
         <td>{{insurance.investmentMarkets}}</td>
         <td>${{insurance.amount}}</td>
         <td>{{insurance.percentage}}%</td>
      </tr>
      {% endfor %}
   </tbody>
   <tbody>
      {% for invest in invest %}
      <tr>
         <th scope="row">Investment</th>
         <td>{{invest.investmentMarkets}}</td>
         <td>${{invest.amount}}</td>
         <td>{{invest.percentage}}%</td>
      </tr>
      {% endfor %}
   </tbody>
   <br>
   <br>
   <tbody>
      <tr>
         <th scope="row">Total</th>
         <td></td>
         <td>${{investments.get_total_amount}}</td>
         <td></td>
      </tr>
   </tbody>
</table>

<a class="btn btn-secondary btn-lg mt-4" href="{% url 'add_savings_url' %}" type="submit">Add Savings</a>
<a class="btn btn-secondary btn-lg mt-4" href="{% url 'add_investments_url' %}" type="submit">Add Investments</a>
<a class="btn btn-secondary btn-lg mt-4" href="{% url 'add_insurances_url' %}" type="submit">Add Insurances</a>

{% else %}


<div class="row">
   <div class="col-4">
      <div class="col-md">
         <div class="card text-center text-dark mb-3">

            <div class="card-body">
               <h2 class="card-title">Welcome Back, {{user.first_name|title}}!</h2>
               <p class="mb-0">Investment Dashboard</p>
            </div>
         </div>
      </div>
   </div>
</div>
<a class="btn btn-success btn-lg mt-4" href="{% url 'investment_url' %}" type="submit">Create Investment Goals</a>
{% endif %}



{% endblock %}
{% block extra_js %}

<script>
   $(document).ready(function () {
      $(document).on("click", ".editable", function () {
         var value = $(this).text();
         var input = "<input type='text' class='input-data' value='" + value + "' class='form-control'> ";
         $(this).html(input);
         $(this).removeClass("editable")
      });

      $(document).on("blur", ".input-data", function () {
         var value = $(this).val();
         var td = $(this).parent("td");
         $(this).remove();
         td.html(value);
         td.addClass("editable");
      })

         (document).on("keypress", ".input-data", function (e) {
            var key = e.code;
            if (key == Enter) {
               var value = $(this).val();
               var td = $(this).parent("td");
               $(this).remove();
               td.html(value);
               td.addClass("editable");
            }
         })
   })
</script>
{% endblock extra_js %}